/*!
 * isolation.is experiments integration library
 * 
 * @license MIT
 * @author Lorenzo Migliorero (lorenzomigliorero@gmail.com)
 * 
 * Documentation at https://isolation.is/api
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.IS=t():e.IS=t()}(this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"../../node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=n},"../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js":function(e,t,n){var o=n("../../node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js");function i(e,t){if(null==e)return{};var n,i,r=o(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(i=0;i<d.length;i++)n=d[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}e.exports=i},"../../node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js":function(e,t){function n(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}e.exports=n},"./src/index.js":function(e,t,n){"use strict";n.r(t);var o=n("../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),i=n.n(o),r="undefined"!=typeof window&&window.location===window.parent.location,d="undefined"!=typeof window&&"ontouchstart"in window,u={MOVE:d?"touchmove":"mousemove",TAP:d?"touchstart":"mousedown"},s=n("../../node_modules/@babel/runtime/helpers/defineProperty.js"),c=n.n(s);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){c()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var f=function(e){return e.changedTouches?e.changedTouches[0]:e},p=function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.title,r=void 0===i?"Title":i,d=o.author,s=void 0===d?"Author":d,c=o.state,a=void 0!==c&&c,p=!1,b=e.contentWindow||window,h={x:0,y:0,width:0,height:0,isPointerInside:!1,state:a},w=function(e){b.postMessage(e)},v=function(){n="function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:window.innerWidth,height:window.innerHeight,top:0,left:0},h.width=n.width,h.height=n.height,h.x=n.width/2,h.y=n.height/2,w({type:"resize",width:h.width,height:h.height})},m=function(e){h.isPointerInside=e.currentTarget===b;var t=f(e).clientX,o=f(e).clientY;h.isPointerInside||(t-=n.left,t=Math.max(0,t),t=Math.min(t,n.width),o-=n.top,o=Math.max(0,o),o=Math.min(o,n.height)),h.x=t,h.y=o,w(l({type:"pointer"},h))},y=function e(n){w(l({type:"tick",timestamp:n},h)),t=window.requestAnimationFrame(e)},g=function(e){h.state=e,w({type:"toggle",state:h.state})},O=function(){p||(window.addEventListener("resize",v),window.addEventListener(u.TAP,m),window.addEventListener(u.MOVE,m),b!==window&&b.addEventListener(u.MOVE,m),v(),w({type:"init",title:r,author:s,state:h.state,width:h.width,height:h.height}),t=window.requestAnimationFrame(y))},j=function(){p=!0,window.cancelAnimationFrame(t),window.removeEventListener("resize",v),window.removeEventListener(u.TAP,m),window.removeEventListener(u.MOVE,m),b.removeEventListener(u.MOVE,m),e.removeEventListener("load",O)};return e.addEventListener("load",O),{onToggle:g,dispose:j}},b=function(e){var t=e.text,n=e.onClick,o=e.disabled,i=window.document.createElement("button");return i.innerHTML=t,i.style.padding="20px",i.style.fontSize="20px",o&&i.setAttribute("disabled",!0),i.onclick=n,i},h=function(e){var t=window.document.createElement("div");t.style.position="fixed",t.style.bottom=0,t.style.padding="20px",t.style.left="50%",t.style.transform="translateX(-50%)";var n=b({text:"BEFORE",onClick:e.onToggle.bind(null,!1),disabled:!0}),o=b({text:"AFTER",onClick:e.onToggle.bind(null,!0)});return t.appendChild(n),t.appendChild(o),window.addEventListener("message",function(e){var t=e.data,i=t.type,r=t.state;"toggle"===i&&(n.removeAttribute("disabled"),o.removeAttribute("disabled"),(r?o:n).setAttribute("disabled",!0))}),t},w=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onInit,o=void 0===n?function(){}:n,d=t.onPointerMove,u=void 0===d?function(){}:d,s=t.onTick,c=void 0===s?function(){}:s,a=t.onChangeState,l=void 0===a?function(){}:a,f=t.onResize,b=void 0===f?function(){}:f,w=function(e){var t=e.origin,n=e.data,d=n.type,s=i()(n,["type"]);("https://isolation.is"===t||r)&&("init"===d?o(s):"pointer"===d?u(s):"tick"===d?c(s):"toggle"===d?l(s.state):"resize"===d&&b(s))};if(window.addEventListener("message",w,!1),r){e=p(window,{debug:!0});var v=h(e);window.document.body.appendChild(v)}return e.dispose||function(){}};n.d(t,"create",function(){return w}),n.d(t,"sync",function(){return p})},0:function(e,t,n){e.exports=n("./src/index.js")}})});